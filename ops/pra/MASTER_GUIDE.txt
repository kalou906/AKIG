#!/bin/bash

##############################################################################
#                   AKIG PRA - MASTER GUIDE & REFERENCE                      #
#              Complete Guide to All PRA Files and Procedures                #
##############################################################################

cat << 'EOF'

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                           â•‘
â•‘                  AKIG PRA - Master Documentation Index                   â•‘
â•‘              Plan de RÃ©cupÃ©ration d'ActivitÃ© - AKIG Application         â•‘
â•‘                                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š DOCUMENTATION STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ops/pra/
â”œâ”€â”€ ğŸ¯ README.md                    # START HERE - Overview & Goals
â”œâ”€â”€ ğŸš¨ RUNBOOK.md                   # Emergency procedures & scenarios
â”œâ”€â”€ ğŸ“Š METRICS.md                   # SLA tracking & performance
â”œâ”€â”€ ğŸ“‹ INDEX.md                     # Guide for different roles
â”œâ”€â”€ âœ… DEPLOYMENT_CHECKLIST.md      # Implementation guide
â”œâ”€â”€ ğŸ“ POST_INCIDENT_TEMPLATE.md    # After-incident documentation
â”œâ”€â”€ âš¡ quickstart.sh                 # Interactive setup & operations
â”œâ”€â”€ ğŸ§ª loadtest.sh                  # Validation testing
â”œâ”€â”€ ğŸ’¾ backup.sh                    # Automated backups
â”œâ”€â”€ ğŸ”„ restore_run.sh               # Restore procedures
â”œâ”€â”€ ğŸŸ¢ status.sh                    # Health monitoring
â””â”€â”€ âš™ï¸  .env.example                 # Configuration template


ğŸ¯ FOR DIFFERENT ROLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‘¨â€ğŸ’¼ MANAGEMENT / EXECUTIVE
  â””â”€ "I need to know the SLA and compliance status"
     1. Read: README.md (Section: "Objectifs de Service")
     2. Review: METRICS.md (Current status)
     3. Time: 10 minutes
     
  â””â”€ "What happens in case of disaster?"
     1. Read: RUNBOOK.md (Section: "Escalade d'urgence")
     2. Know: P1 resolution time = 30 minutes max
     3. Time: 10 minutes

ğŸ—ï¸ INFRASTRUCTURE / DEVOPS TEAM
  â””â”€ "I need to set up the PRA"
     1. Run: ./quickstart.sh install
     2. Read: README.md (Full)
     3. Read: DEPLOYMENT_CHECKLIST.md
     4. Time: 1-2 days

  â””â”€ "How do I monitor the PRA?"
     1. Daily: ./quickstart.sh status
     2. Weekly: ./quickstart.sh test-restore
     3. Monthly: ./loadtest.sh
     4. Time: 1 hour/month

ğŸ§ª QA / TEST TEAM
  â””â”€ "How do I validate the PRA?"
     1. Run: ./loadtest.sh
     2. Review: Generated report
     3. Time: 45 minutes

ğŸ”’ SECURITY / AUDIT TEAM
  â””â”€ "Is the PRA secure and compliant?"
     1. Read: RUNBOOK.md (Section: "ScÃ©nario 3: Attaque")
     2. Verify: Security checklist in DEPLOYMENT_CHECKLIST.md
     3. Audit: Backup permissions, encryption, access logs
     4. Time: 1-2 hours

ğŸ“± ON-CALL / SUPPORT TEAM
  â””â”€ "Incident declared P1! What do I do?"
     1. Open: RUNBOOK.md (Keep on screen)
     2. Find: Your scenario (DB down? Data corrupted? Attack?)
     3. Follow: Step-by-step procedure
     4. Contact: Escalation numbers at bottom of RUNBOOK.md
     5. Time: Real-time reference during incident


ğŸ“– HOW TO READ THE DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SCENARIO 1: "We're going live with PRA tomorrow!"
  1. README.md                    (15 min) - Understand architecture
  2. DEPLOYMENT_CHECKLIST.md      (30 min) - Go through checklist
  3. Run: quickstart.sh install   (30 min) - Set everything up
  4. RUNBOOK.md (skim)            (10 min) - Know where emergency procedures are
  Total: 1.5 hours

SCENARIO 2: "I'm on-call this week"
  1. RUNBOOK.md                   (30 min) - Read ALL scenarios
  2. INDEX.md (On-Call section)   (10 min) - Understand workflow
  3. Contacts (bottom of file)    (2 min)  - Know who to call
  4. .env / credentials           (5 min)  - Know how to access systems
  Total: 1 hour

SCENARIO 3: "P1 incident declared RIGHT NOW!"
  1. RUNBOOK.md                   (ON SCREEN) - Reference only
  2. Find your scenario
  3. Execute step-by-step
  4. When blocked: Call contacts
  5. After resolution: POST_INCIDENT_TEMPLATE.md
  Total: DURING incident + 30 min after

SCENARIO 4: "Monthly compliance check"
  1. ./loadtest.sh               (45 min) - Run validation
  2. METRICS.md                  (10 min) - Update dashboard
  3. Generate report
  4. Send to management
  Total: 1 hour


âš¡ QUICK START - FIRST 30 MINUTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Step 1: Prepare Environment (5 min)
  ssh ops@production-server
  cd /opt/akig/ops/pra
  ls -la

Step 2: Configure (5 min)
  cp .env.example .env
  vim .env            # Edit with your values
  chmod 600 .env      # Secure it

Step 3: Install (10 min)
  chmod +x *.sh
  ./quickstart.sh install
  # Follows you through setup

Step 4: Verify (10 min)
  ./status.sh         # Should show: "All checks passed âœ“"
  ls -lh /backups/akig/*.sql.gz  # Should see recent backup


ğŸ’¡ COMMAND REFERENCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Interactive mode (recommended)
./quickstart.sh install         # First-time setup
./quickstart.sh daily           # Run today's backup
./quickstart.sh test-restore    # Test the restore
./quickstart.sh monitor         # Continuous monitoring
./quickstart.sh status          # Quick health check
./quickstart.sh help            # Show help

# Direct scripts (power users)
./backup.sh --full              # Full backup
./backup.sh --incremental       # Incremental backup
./status.sh                     # Health check
./loadtest.sh                   # Full validation

# Manual operations
psql -d akig -c "SELECT count(*) FROM users;"  # Query DB
pg_dump -d akig | gzip > backup.sql.gz         # Manual backup


ğŸ“ LEARNING PATH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Beginner (Never used PRA):
  Day 1: Read README.md
  Day 2: Read INDEX.md + METRICS.md
  Day 3: Run quickstart.sh install
  Day 4: Watch RUNBOOK.md scenarios
  Day 5: Run loadtest.sh
  â†’ Can now: Understand PRA, run basic operations

Intermediate (Some knowledge):
  Day 1: Setup PRA in new environment
  Day 2: Configure monitoring
  Day 3: Run weekly restore test
  Day 4: Handle minor incidents
  â†’ Can now: Deploy PRA, run operations, troubleshoot

Advanced (Expert):
  Day 1: Optimize scripts for your infrastructure
  Day 2: Implement custom monitoring
  Day 3: Design disaster recovery strategy
  Day 4: Run disaster drills
  â†’ Can now: Manage PRA, optimize performance, lead drills


ğŸ“Š DECISION TREE - "WHAT DO I READ?"
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                          â”Œâ”€ README.md
          NEW USER?       â”‚
             YES          â””â”€ Start with overview
             â”‚
             â”œâ”€ Need setup help?
             â”‚  YES â†’ DEPLOYMENT_CHECKLIST.md
             â”‚  NO  â†’ Continue
             â”‚
             â”œâ”€ In production issue?
             â”‚  YES â†’ RUNBOOK.md (Find your scenario)
             â”‚  NO  â†’ Continue
             â”‚
             â”œâ”€ Need to test?
             â”‚  YES â†’ Run: ./loadtest.sh
             â”‚  NO  â†’ Continue
             â”‚
             â”œâ”€ Checking compliance?
             â”‚  YES â†’ METRICS.md
             â”‚  NO  â†’ Continue
             â”‚
             â””â”€ Something went wrong?
                YES â†’ POST_INCIDENT_TEMPLATE.md
                NO  â†’ You're good!


ğŸ” FINDING WHAT YOU NEED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

"How do I..."

  ...backup my database?
    â†’ README.md: "Sauvegarde Quotidienne"
    â†’ Run: ./quickstart.sh daily

  ...test the restore?
    â†’ README.md: "Test de Restauration"
    â†’ Run: ./quickstart.sh test-restore

  ...check if PRA is healthy?
    â†’ Run: ./status.sh

  ...validate SLA compliance?
    â†’ Run: ./loadtest.sh
    â†’ Check: METRICS.md

  ...handle a P1 incident?
    â†’ RUNBOOK.md: Find your scenario
    â†’ Call: On-call contacts

  ...optimize backup speed?
    â†’ README.md: "DÃ©pannage"
    â†’ Edit: .env (compression settings)
    â†’ Test: Run loadtest.sh again

  ...understand what happens after incident?
    â†’ POST_INCIDENT_TEMPLATE.md

  ...train my team?
    â†’ INDEX.md: By role
    â†’ Walk through: Scenarios in RUNBOOK.md


âœ… REGULAR MAINTENANCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DAILY (2 minutes)
  â–¡ ./status.sh
  â–¡ Check: No critical alerts

WEEKLY (30 minutes)
  â–¡ ./quickstart.sh test-restore
  â–¡ Review: Restore report
  â–¡ Check: Data integrity

MONTHLY (1 hour)
  â–¡ ./loadtest.sh
  â–¡ Update: METRICS.md
  â–¡ Review: Compliance status
  â–¡ Share: Report with management

QUARTERLY (4 hours)
  â–¡ Disaster recovery drill
  â–¡ Simulate full incident
  â–¡ Test escalation procedures
  â–¡ Document learnings
  â–¡ Update RUNBOOK.md if needed

ANNUALLY (1 day)
  â–¡ Full PRA review
  â–¡ Update SLA targets if needed
  â–¡ Review all procedures
  â–¡ Test all scenarios
  â–¡ Update documentation


ğŸš¨ IN CASE OF EMERGENCY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INCIDENT DECLARED? FOLLOW THESE STEPS:

1. IMMEDIATE (< 1 minute)
   - Stay calm
   - Open: RUNBOOK.md
   - Find: Your incident type

2. DIAGNOSIS (1-5 min)
   - Follow: "Diagnostic" steps for your scenario
   - Note: Time and symptoms
   - Call: Primary contact if unsure

3. RECOVERY (5-30 min)
   - Follow: "Actions correctives" steps
   - Execute: Recommended procedure
   - Monitor: Status.sh output
   - Ask for help if stuck

4. VERIFICATION (30 min)
   - Test: All critical systems
   - Verify: Data integrity
   - Check: API endpoints
   - Confirm: Service restored

5. COMMUNICATION (Immediate)
   - Update: Status page
   - Notify: Stakeholders
   - Send: Incident report

6. DOCUMENTATION (After incident)
   - Complete: POST_INCIDENT_TEMPLATE.md
   - Schedule: Post-mortem meeting
   - Create: Action items
   - Share: With team

CONTACTS:
  Tier 1 (Immediate): ops-oncall@akig.com
  Tier 2 (5 min):     cto@akig.com
  Tier 3 (15 min):    coo@akig.com


ğŸ“ SUPPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Questions about PRA:
  â†’ Email: ops@akig.com
  â†’ Slack: #infrastructure
  â†’ Wiki: Search "PRA"

Issues with scripts:
  â†’ Check: logs in /var/log/akig_*
  â†’ Test: ./status.sh first
  â†’ Review: README.md "DÃ©pannage"
  â†’ Escalate: ops@akig.com

Document updates:
  â†’ Create: GitHub issue with "PRA" tag
  â†’ Propose: Changes with details
  â†’ Discuss: With team before implementing


ğŸ”— RELATED DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Within PRA:
  â”œâ”€ README.md              (Architecture, setup, usage)
  â”œâ”€ RUNBOOK.md             (Emergency scenarios)
  â”œâ”€ METRICS.md             (SLA tracking, compliance)
  â”œâ”€ INDEX.md               (Documentation index)
  â”œâ”€ DEPLOYMENT_CHECKLIST.md (Implementation guide)
  â””â”€ POST_INCIDENT_TEMPLATE.md (Post-mortem template)

External references:
  â”œâ”€ PostgreSQL Docs: https://www.postgresql.org/docs/current/
  â”œâ”€ pg_dump Manual: https://www.postgresql.org/docs/current/app-pgdump.html
  â”œâ”€ Bash Scripting: https://www.gnu.org/software/bash/manual/
  â””â”€ Company Wiki: [Your internal documentation]


âœ¨ BEST PRACTICES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. AUTOMATE
   â–¡ Setup cron for backup.sh (hourly)
   â–¡ Setup cron for status.sh (every 5 min)
   â–¡ Enable Slack/Email alerts

2. TEST REGULARLY
   â–¡ Weekly restore test (quickstart.sh test-restore)
   â–¡ Monthly load test (./loadtest.sh)
   â–¡ Quarterly disaster drill

3. DOCUMENT EVERYTHING
   â–¡ Keep incident reports
   â–¡ Update METRICS.md monthly
   â–¡ Share learnings with team

4. MONITOR CLOSELY
   â–¡ Watch backup logs daily
   â–¡ Review monitoring output
   â–¡ Alert on deviations from SLA

5. TRAIN YOUR TEAM
   â–¡ On-call training
   â–¡ Scenario walkthroughs
   â–¡ Regular drills


ğŸ“ˆ SUCCESS METRICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Your PRA is successful when:

  âœ… Backup success rate: 100% (no missed backups)
  âœ… RPO: 1 hour or better (data loss < 1 hour)
  âœ… RTO: 30 minutes or better (downtime < 30 min)
  âœ… Restore test pass rate: 100% (weekly tests work)
  âœ… Team trained: Everyone knows procedures
  âœ… Incident response: P1 resolved < 30 min
  âœ… SLA compliance: Month-to-month 99.9%+ uptime

If any metric fails: Update procedures and notify team.


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‰ YOU'RE READY TO DEPLOY!

Next steps:
  1. Read: README.md
  2. Configure: .env
  3. Run: ./quickstart.sh install
  4. Verify: ./status.sh
  5. Join: #infrastructure on Slack
  6. Share: This guide with your team

Good luck! ğŸš€

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Version: 1.0 | Date: Oct 25, 2025 | Status: ğŸŸ¢ PRODUCTION READY

For questions: ops@akig.com
For emergencies: ops-oncall@akig.com (+33 6XX XX XX XX)

EOF
